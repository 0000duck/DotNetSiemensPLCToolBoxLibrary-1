<Window x:Class="WPFVarTab.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:Shell="clr-namespace:Microsoft.Windows.Shell;assembly=Microsoft.Windows.Shell" 
        xmlns:WPFVarTab="clr-namespace:WPFVarTab" 
        Style="{DynamicResource GlassStyle}"
        Title="JFK-WpfVarTab" Height="350" Width="525" Name="ThisWindow" WindowStyle="SingleBorderWindow">

    <Window.CommandBindings>
        <CommandBinding Command="{x:Static Shell:SystemCommands.ShowSystemMenuCommand}"
                        Executed="_OnShowSystemMenuCommand"/>
        <CommandBinding Command="{x:Static Shell:SystemCommands.CloseWindowCommand}"
                        Executed="_OnSystemCommandCloseWindow"/>
    </Window.CommandBindings>
    
    <Window.Resources>
        <Style x:Key="GlassStyle" TargetType="{x:Type WPFVarTab:MainWindow}">
            <Setter Property="Shell:WindowChrome.WindowChrome">
                <Setter.Value>
                    <Shell:WindowChrome GlassFrameThickness="-1" ResizeBorderThickness="4"  CaptionHeight="36"/>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type WPFVarTab:MainWindow}">
                        <Grid>
                            <ContentPresenter
                                Margin="7,14,7,7" Content="{TemplateBinding Content}"/>
                            <StackPanel Orientation="Horizontal">
                            <Button Shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                    Margin="7,7,0,2"
                                    VerticalAlignment="Top" 
                                    HorizontalAlignment="Left"                                      
                                    Padding="3"
                                    Command="{x:Static Shell:SystemCommands.ShowSystemMenuCommand}" CommandParameter="{Binding ElementName=ThisWindow}">
                                    <Image Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Icon}" Width="16" Height="16"/>
                            </Button>
                                <Button Margin="20,7,0,2" 
                                        VerticalAlignment="Top" 
                                        Shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                        HorizontalAlignment="Left" 
                                        Padding="3"
                                        ToolTip="Open an existing VarTab">
                                        <Image Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Icon}" Width="16" Height="16"/>
                                </Button>
                                <Button Margin="2,7,0,2" 
                                        VerticalAlignment="Top" 
                                        Shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                        HorizontalAlignment="Left" 
                                        Padding="3"
                                        ToolTip="Save VarTab">
                                    <Image Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Icon}" Width="16" Height="16"/>
                                </Button>
                                <Button Margin="2,7,0,2" 
                                        VerticalAlignment="Top" 
                                        Shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                        HorizontalAlignment="Left" 
                                        Padding="3"
                                        ToolTip="Config Connections">
                                    <Image Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Icon}" Width="16" Height="16"/>
                                </Button>
                                <Button Margin="2,7,0,2" 
                                        VerticalAlignment="Top" 
                                        Shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                        HorizontalAlignment="Left" 
                                        Padding="3"
                                        ToolTip="Online View">
                                    <Image Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Icon}" Width="16" Height="16"/>
                                </Button>
                                <Button Margin="2,7,0,2" 
                                        VerticalAlignment="Top" 
                                        Shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                        HorizontalAlignment="Left" 
                                        Padding="3"
                                        ToolTip="Control Values">
                                    <Image Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Icon}" Width="16" Height="16"/>
                                </Button>
                                <Button Margin="2,7,0,2" 
                                        VerticalAlignment="Top" 
                                        Shell:WindowChrome.IsHitTestVisibleInChrome="True"
                                        HorizontalAlignment="Left" 
                                        Padding="3"
                                        ToolTip="VarTab Options">
                                    <Image Source="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Icon}" Width="16" Height="16"/>
                                </Button>
                            </StackPanel>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        
               
        <DataGrid AutoGenerateColumns="False" Margin="0,22,0,22" Name="dataGrid" Grid.RowSpan="2">
            <DataGrid.Columns>
                <DataGridTemplateColumn Header="Comment" Width="Auto" IsReadOnly="True" SortMemberPath="Comment" >
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Comment}" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn Header="Address" Width="Auto" IsReadOnly="True" SortMemberPath="LibNoDaveValue.S7FormatAddress">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding LibNoDaveValue.S7FormatAddress}" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn Header="Symbol" Width="Auto" IsReadOnly="True" SortMemberPath="LibNoDaveValue.S7FormatAddress">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding LibNoDaveValue.S7FormatAddress}" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn Header="DataType" Width="Auto" IsReadOnly="True" SortMemberPath="LibNoDaveValue.LibNoDaveDataType">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding LibNoDaveValue.LibNoDaveDataType}" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn Header="DisplayFormat" Width="Auto" IsReadOnly="True" SortMemberPath="LibNoDaveValue.DataTypeStringFormat">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding LibNoDaveValue.DataTypeStringFormat}" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn Header="Value" Width="Auto" IsReadOnly="True" SortMemberPath="LibNoDaveValue.Value">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding LibNoDaveValue.Value}" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn Header="ControlValue" Width="Auto" IsReadOnly="True" SortMemberPath="LibNoDaveValue.ControlValue">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding LibNoDaveValue.ControlValue}" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

            </DataGrid.Columns>
        </DataGrid>
        <StatusBar HorizontalContentAlignment="Stretch" Grid.Row="1" Name="statusBar" Height="22" VerticalAlignment="Bottom" Opacity="0.5">
            <StatusBarItem DockPanel.Dock="Right" HorizontalAlignment="Right"  Width="40" />
            <StatusBarItem DockPanel.Dock="Right" VerticalContentAlignment="Stretch">
                <ProgressBar Width="50" VerticalAlignment="Stretch" Value="0" IsIndeterminate="False"></ProgressBar>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Stretch" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch">
                <Label Padding="0">JFK-WpfVarTab 1.0</Label>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
